[build]
  base = ""
  # Build command - ensure it runs Next.js build
  command = "rm -f yarn.lock && npm install --legacy-peer-deps && npm run build"
  publish = ".next"

[build.environment]
  NODE_VERSION = "20.19.0"
  NPM_FLAGS = "--legacy-peer-deps"
  # Try to force npm
  NETLIFY_USE_NPM = "true"
  # CRITICAL: NEXTAUTH_URL must be set in Netlify UI for the plugin to work
  # The plugin reads this during onBuild event, so it must be available
  # Set in Netlify UI: Site settings → Build & deploy → Environment
  # Use your actual Netlify site URL (e.g., https://profilechan.netlify.app)
  NEXTAUTH_URL = "https://placeholder.netlify.app"

[functions]
  node_bundler = "esbuild"
  included_files = ["prisma/**/*"]

